{
    "title": "How does vulnerability work? - Quora",
    "tags": [
        "Vulnerability Assessment",
        "Vulnerabilities",
        "Alibaba Cloud",
        "Emotional Vulnerability"
    ],
    "response": [
        {
            "author_info": {
                "name": "Michael Bohm",
                "href": "/profile/Michael-Bohm-3"
            },
            "answer_text": "With a comparison to the official fix instruction released by ThinkPHP, we analyzed the code under /thinkphp/library/think/Route.php where ThinkPHP schedules for route parsing. The \"parseUrlPath\" function calls the path function and parses the routing information in \"pathinfo\". The URL in the function is divided by slashes (/) without applying any filter. After searching for \"pathinfo\", we find that //thinkphp/library/think/Request.phpdefines the \"pathinfo\" function which gets the URL. An attacker can exploit the value of \"$_GET\" for command injection: the parameter of \"var_pathinfo\" is \"s\", where the function for command injection can be created. We also analyzed the app.php code for route scheduling, which operates the controller through the \"controller\" variable, instantiates the controller, and tracks the controller method. In //thinkphp/library/think/Loader.php, the controller calls \"parseModuleAndClass\" to parse \"$name\" and instantiate \"$class\". When \"$name\" matches with a backslash (\\), it is used as a method and class in \"strpos($name, '\\')\". An attacker can construct and instantiate any method to be called, and instantiate the \"namespaceclass\" class to execute the \"call_user_func_array\" method. https://www.alibabacloud.com/blog/alibaba-cloud-discovers-the-latest-thinkphp-v5-vulnerability_594307?spm=a2c41.12450933.0.0 ",
            "date": "Answered December 29, 2018",
            "views": "62",
            "upvotes": "0"
        }
    ]
}